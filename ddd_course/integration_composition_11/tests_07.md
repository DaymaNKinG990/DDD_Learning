# Тесты по модулю "Интеграция и Композиция в DDD"

Эти тесты предназначены для проверки вашего понимания принципов интеграции Ограниченных Контекстов, паттернов Карты Контекстов и технических аспектов их взаимодействия.

## Задание 1: Анализ Карты Контекстов

Дана следующая Карта Контекстов для системы управления авиаперевозками:

*   **Контекст "Продажа Билетов" (Ticketing):** Отвечает за поиск рейсов, бронирование и продажу билетов.
*   **Контекст "Управление Рейсами" (Flight Management):** Отвечает за расписание рейсов, назначение бортов, управление экипажами.
*   **Контекст "Программа Лояльности" (Loyalty Program):** Отвечает за начисление миль, управление уровнями участников, предоставление бонусов.
*   **Контекст "Уведомления Клиентов" (Notifications):** Отвечает за отправку email и SMS уведомлений (например, об изменении рейса, напоминание о вылете).
*   **Контекст "Платежная Система" (Payment Gateway):** Внешняя система для обработки платежей.

**Предполагаемые взаимосвязи:**

1.  `Ticketing` (D) --- `Flight Management` (U): `Ticketing` запрашивает доступные рейсы и цены у `Flight Management`.
2.  `Ticketing` (U) --- `Loyalty Program` (D): После покупки билета `Ticketing` сообщает `Loyalty Program` о сумме покупки для начисления миль. `Loyalty Program` также может предоставлять `Ticketing` информацию о скидках для участника.
3.  `Ticketing` (U) --- `Notifications` (D): `Ticketing` инициирует отправку подтверждения бронирования через `Notifications`.
4.  `Flight Management` (U) --- `Notifications` (D): `Flight Management` инициирует отправку уведомления об изменении статуса рейса.
5.  `Ticketing` (D) --- `Payment Gateway` (U): `Ticketing` использует `Payment Gateway` для обработки оплаты билета.

**Вопросы:**

1.  Для каждой из 5 указанных взаимосвязей предложите наиболее подходящий паттерн из Карты Контекстов (например, Клиент-Поставщик, ACL, Партнерство, Опубликованный Язык и т.д.). Кратко обоснуйте свой выбор для каждой связи.
2.  Какой контекст вы бы определили как наиболее "вышестоящий" (upstream) по отношению к `Ticketing` в части информации о рейсах?
3.  Если бы модель данных `Payment Gateway` была очень сложной и негибкой, какой паттерн применил бы `Ticketing` для взаимодействия с ним? Опишите кратко его суть.

## Задание 2: Выбор Способа Интеграции

Рассмотрим взаимодействие между контекстами "Управление Заказами" (Order Management) и "Складской Учет" (Inventory).

*   "Управление Заказами" должно проверить наличие товара на складе перед подтверждением заказа.
*   После отгрузки заказа "Складской Учет" должен уменьшить количество товара на складе.

**Вопросы:**

1.  Для проверки наличия товара: какой способ интеграции (синхронный или асинхронный) вы бы выбрали? Почему? Приведите пример технологии (например, REST API, gRPC, сообщение в очередь).
2.  Для обновления остатков на складе после отгрузки: какой способ интеграции (синхронный или асинхронный) здесь более уместен? Почему? Опишите, как бы это могло работать с использованием Доменных Событий.
3.  Что такое "сага" (Saga) в контексте распределенных транзакций? Могла бы сага быть полезна для процесса "заказ-оплата-отгрузка-обновление склада"? Кратко поясните.

## Задание 3: Проектирование Антикоррупционного Слоя (ACL)

Контекст "Новостная Лента Пользователя" должен отображать статьи из внешнего "Агрегатора Новостей". API агрегатора возвращает статьи в следующем формате:

```xml
<article>
  <article_id>123</article_id>
  <headline_text>Сенсация!</headline_text>
  <full_content mime_type="text/html"><![CDATA[<p>Очень длинный HTML...</p>]]></full_content>
  <publication_date_unix_ts>1677619200</publication_date_unix_ts>
  <source_name>СуперНовости.com</source_name>
</article>
```

Внутренняя модель статьи в "Новостной Ленте Пользователя" выглядит так:

```python
class NewsArticle:
    id: str
    title: str
    summary: str # Краткое содержание
    published_at: datetime
    source: str
```

**Вопросы:**

1.  Опишите, какие задачи будет выполнять Антикоррупционный Слой (ACL) на стороне "Новостной Ленты Пользователя" при получении данных от "Агрегатора Новостей".
2.  Какие компоненты может включать этот ACL (например, Адаптер, Транслятор)?
3.  Как ACL поможет защитить доменную модель "Новостной Ленты" от изменений в API "Агрегатора Новостей"?

## Задание 4: Микрофронтенды

1.  Дайте определение понятию "Микрофронтенды".
2.  Назовите два основных преимущества и две основные сложности, связанные с использованием архитектуры Микрофронтендов.
3.  Какой механизм композиции микрофронтендов (например, на стороне сервера, во время сборки, на стороне клиента) вы бы выбрали для портала с множеством независимых разделов (новости, погода, почта, игры) и почему?

## Критерии оценки:

*   Правильность применения паттернов Карты Контекстов.
*   Обоснованность выбора синхронных/асинхронных способов интеграции.
*   Понимание роли и структуры ACL.
*   Знание концепций Микрофронтендов.
*   Четкость и полнота ответов.
