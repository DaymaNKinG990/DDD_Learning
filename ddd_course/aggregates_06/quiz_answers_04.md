# Ответы на квиз по модулю "Агрегаты (Aggregates)"

## Ответы

1.  **Ответ:** B) Быть единственной точкой входа для всех команд, изменяющих состояние Агрегата, и обеспечивать соблюдение инвариантов.
    *   **Пояснение:** Корень Агрегата инкапсулирует внутренние детали и контролирует все изменения, гарантируя, что Агрегат всегда остается в согласованном состоянии.

2.  **Ответ:** B) Граница, в пределах которой все инварианты должны быть соблюдены и обеспечена транзакционная согласованность после каждого изменения.
    *   **Пояснение:** Агрегат определяет область, в которой данные должны быть атомарно согласованы. Изменения внутри Агрегата обычно происходят в рамках одной транзакции.

3.  **Ответ:** B) Только через идентификаторы (ID) Корней других Агрегатов.
    *   **Пояснение:** Ссылки по ID помогают поддерживать слабую связанность между Агрегатами, предотвращая каскадные загрузки и упрощая управление жизненным циклом. Прямые объектные ссылки могут привести к созданию слишком больших кластеров объектов.

4.  **Ответ:** B) Бизнес-правила и условия, которые должны всегда оставаться истинными для Агрегата на протяжении всего его жизненного цикла.
    *   **Пояснение:** Инварианты — это ключевые бизнес-правила, которые Корень Агрегата обязан защищать при любых операциях изменения состояния.

5.  **Ответ:** C) Размер Агрегата должен определяться границами транзакционной согласованности; они должны быть достаточно малы, чтобы избежать проблем с производительностью и блокировками, но достаточно велики, чтобы обеспечить инварианты.
    *   **Пояснение:** Правильный баланс размера Агрегата критичен. Слишком большие Агрегаты могут привести к проблемам с производительностью и параллелизмом, слишком маленькие — к невозможности обеспечить важные инварианты атомарно.

6.  **Ответ:** C) Корень Агрегата (Aggregate Root).
    *   **Пояснение:** Именно Корень Агрегата содержит логику для проверки и обеспечения соблюдения всех инвариантов перед изменением состояния Агрегата.

7.  **Ответ:** C) Чтобы обеспечить масштабируемость, избежать распределенных транзакций и упростить управление согласованностью данных.
    *   **Пояснение:** Ограничение транзакций одним Агрегатом упрощает блокировки, снижает риск взаимоблокировок и делает систему более масштабируемой. Согласованность между Агрегатами достигается через итоговую согласованность (eventual consistency), если это допустимо.

8.  **Ответ:** C) `ПозицияЗаказа` (OrderItem)
    *   **Пояснение:** `ПозицияЗаказа` обычно является внутренней Сущностью Агрегата `Заказ` (Order). Она не имеет смысла и собственного жизненного цикла вне контекста Заказа. `Заказ` и `Клиент` являются классическими примерами Корней Агрегатов. `Продукт` также, скорее всего, будет Корнем Агрегата, на который ссылаются из других Агрегатов (например, из `ПозицииЗаказа` по ID).
